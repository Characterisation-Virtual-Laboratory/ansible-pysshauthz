# Configure pysshauthz Sites 
This playbook role is used to configure pysshauthz service.
The main configuration that needs to be done here is to add the site names into `vars/main.yml`. See `main.yml.example` for example.

## Configure pysshauthz
1. Add site names into `vars/main.yml`
2. Run the playbook with the `--tags=configure-sites-pysshauthz` switch to run this role
```
ansible-playbook -i inventory play.yml --tags=setup-pysshauthz
```

# Configure site clients
The SSHD service on sites that use this service will need to be configured to trust the certificate authority (CA) generated by pysshauthz. Ideally, each site will have its own CA file. The following steps need to be done on every node on the site.

1. Copy the `<sitename>_ca.pub` to `/etc/ssh/<sitename>_ca.pub`
2. Add `TrustedUserCAKeys /etc/ssh/<sitename>_ca.pub` into `/etc/ssh/sshd_config`
3. Restart SSHD service `systemctl restart sshd`